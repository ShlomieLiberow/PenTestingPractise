# coding=utf-8
import winreg

net = r"SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged"
key = winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE, net, 0, winreg.KEY_WOW64_64KEY + winreg.KEY_ALL_ACCESS)


def val2addr(val):
    # '0' - zero-padded, Width 2,'X' - formatted as Hex.
    return ':'.join('{:02X}'.format(a) for a in val)


for i in range(13):
    try:
        guid = winreg.EnumKey(key, i)
        netKey = winreg.OpenKey(key, str(guid))
        (n, macAddr, t) = winreg.EnumValue(netKey, 5)
        (n, name, t) = winreg.EnumValue(netKey, 4)
        netName = str(name)
        if macAddr is None:
            continue
        # print(binascii.unhexlify(x))
        print('[+] ' + netName + ' ' + val2addr(macAddr))
    # winreg.CloseKey(netKey)
    except Exception as e:
        print(e)
        break
